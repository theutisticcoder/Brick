window['createExportVideoApi']=()=>{const exportVideoApi={};let svgContainer=null;let svgElement=null;let clipElement=null;let seekCount=0;let seekCountPromise=null;let seekCountPromiseResolve=null;let seekCountPromiseReject=null;exportVideoApi['prepareCapturing']=(svgContent,pageWidth,pageHeight,videoWidth,videoHeight)=>{return new Promise((resolve,reject)=>{try{if(clipElement!=null){clipElement.remove();clipElement=null;}
if(svgElement!=null){window['disposeAnimation'](svgElement,0);svgElement.remove();svgElement=null;}
if(svgContainer!=null){svgContainer.remove();svgContainer=null;}
clipElement=document.createElement('div');clipElement.setAttribute('id','ani-api-clip');clipElement.style.position='absolute';clipElement.style.width=`${videoWidth}px`;clipElement.style.height=`${videoHeight}px`;document.body.appendChild(clipElement);svgContainer=document.createElement('div');svgContainer.style.transform=`scale(${Math.max(videoWidth/pageWidth,videoHeight/pageHeight)})`;svgContainer.style.transformOrigin='0 0';document.body.appendChild(svgContainer);svgElement=new DOMParser().parseFromString(svgContent,'image/svg+xml').documentElement;svgContainer.appendChild(svgElement);svgElement.style.transformOrigin='0 0';exportVideoApi['startCapturing']=()=>{return new Promise((resolve,reject)=>{window['initAnimation'](svgElement,0,{}).then(resolve).catch(reject);});};setTimeout(()=>{resolve({'svgElement':svgElement});},1000);}catch(error){reject(error);}});};exportVideoApi['startCapturing']=()=>{return Promise.resolve(true);};exportVideoApi['isCapturing']=()=>{return clipElement!=null;};exportVideoApi['resetSeekCount']=()=>{seekCount=0;if(seekCountPromise!=null){seekCountPromiseReject(false);seekCountPromise=null;seekCountPromiseResolve=null;seekCountPromiseReject=null;}};exportVideoApi['waitForSeekCount']=()=>{if(seekCount==0){return Promise.resolve(true);}
if(seekCountPromise==null){seekCountPromise=new Promise((resolve,reject)=>{seekCountPromiseResolve=resolve;seekCountPromiseReject=reject;});}
return seekCountPromise};exportVideoApi['increaseSeekCount']=()=>{seekCount++;};exportVideoApi['decreaseSeekCount']=()=>{seekCount--;if(seekCount==0&&seekCountPromise!=null){seekCountPromiseResolve(true);seekCountPromise=null;seekCountPromiseResolve=null;seekCountPromiseReject=null;}};exportVideoApi['seekTo']=(time)=>{return window['seekAnimationTo'](svgElement,0,time);};return exportVideoApi;};